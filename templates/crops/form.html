{% extends 'base.html' %}
{% block content %}
<div class="min-h-screen bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 px-4 py-8">
    <!-- Header -->
    <div class="max-w-md mx-auto mb-8 text-center animate-fade-in-down">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full mb-4 shadow-lg animate-bounce-gentle">
            <span class="text-2xl">üåæ</span>
        </div>
        <h1 class="text-2xl md:text-3xl font-bold bg-gradient-to-r from-green-700 to-emerald-700 bg-clip-text text-transparent mb-2">
            Smart Crop Advisor
        </h1>
        <p class="text-gray-600 text-sm">Get AI-powered crop recommendations</p>
    </div>

    <!-- Main Form Container -->
    <div class="max-w-md mx-auto bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20 p-6 animate-fade-in-up">
        <form method="post" class="space-y-6">
            {% csrf_token %}
            
            <!-- Location Field -->
            <div class="form-group animate-slide-in" style="animation-delay: 0.1s;">
                <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                    <span class="text-lg mr-2">üìç</span>
                    Location/Area
                </label>
                <div class="relative">
                    <input type="text" 
                           name="location" 
                           class="w-full p-4 pl-12 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all duration-300 bg-gray-50/50 hover:bg-white focus:bg-white text-gray-800 placeholder-gray-400" 
                           placeholder="e.g., Punjab, India"
                           required>
                    <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Soil Type Field -->
            <div class="form-group animate-slide-in" style="animation-delay: 0.2s;">
                <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                    <span class="text-lg mr-2">üå±</span>
                    Soil Type
                </label>
                <div class="relative">
                    <input type="text" 
                           name="soil_type" 
                           class="w-full p-4 pl-12 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all duration-300 bg-gray-50/50 hover:bg-white focus:bg-white text-gray-800 placeholder-gray-400" 
                           placeholder="e.g., Clay, Sandy, Loamy"
                           required>
                    <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-green-500">
                        üå±
                    </div>
                </div>
            </div>

            <!-- Weather Conditions Field -->
            <div class="form-group animate-slide-in" style="animation-delay: 0.3s;">
                <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                    <span class="text-lg mr-2">üå¶Ô∏è</span>
                    Weather Conditions
                </label>
                <div class="relative">
                    <input type="text" 
                           name="weather" 
                           class="w-full p-4 pl-12 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all duration-300 bg-gray-50/50 hover:bg-white focus:bg-white text-gray-800 placeholder-gray-400" 
                           placeholder="e.g., Hot & Humid, Moderate rainfall"
                           required>
                    <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-blue-500">
                        üå¶Ô∏è
                    </div>
                </div>
            </div>

            <!-- Water Availability Field -->
            <div class="form-group animate-slide-in" style="animation-delay: 0.4s;">
                <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                    <span class="text-lg mr-2">üíß</span>
                    Water Availability
                </label>
                <div class="relative">
                    <input type="text" 
                           name="water_availability" 
                           class="w-full p-4 pl-12 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all duration-300 bg-gray-50/50 hover:bg-white focus:bg-white text-gray-800 placeholder-gray-400" 
                           placeholder="e.g., Irrigation available, Rainfall dependent"
                           required>
                    <div class="absolute left-4 top-1/2 transform -translate-y-1/2 text-blue-400">
                        üíß
                    </div>
                </div>
            </div>

            <!-- Additional Notes Field -->
            <div class="form-group animate-slide-in" style="animation-delay: 0.5s;">
                <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                    <span class="text-lg mr-2">üìù</span>
                    Additional Notes
                    <span class="text-xs text-gray-500 ml-2 font-normal">(Optional)</span>
                </label>
                <div class="relative">
                    <textarea name="additional_notes" 
                              rows="4" 
                              class="w-full p-4 pl-12 pt-4 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all duration-300 bg-gray-50/50 hover:bg-white focus:bg-white text-gray-800 placeholder-gray-400 resize-none" 
                              placeholder="Any specific requirements or constraints..."></textarea>
                    <div class="absolute left-4 top-4 text-gray-400">
                        üìù
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="animate-slide-in" style="animation-delay: 0.6s;">
                <button type="submit" 
                        class="submit-btn w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-[1.02] hover:shadow-lg active:scale-[0.98] flex items-center justify-center space-x-2">
                    <span>üöÄ</span>
                    <span>Get Smart Recommendations</span>
                    <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </button>
            </div>
        </form>
    </div>

    <!-- Suggestion Results -->
    {% if suggestion %}
    <div class="max-w-md mx-auto mt-6 bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-green-200 overflow-hidden animate-slide-up-result">
        <!-- Header -->
        <div class="bg-gradient-to-r from-green-500 to-emerald-500 p-4">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
                    <span class="text-lg">‚úÖ</span>
                </div>
                <div>
                    <h3 class="text-lg font-bold text-white">AI Recommendation</h3>
                    <p class="text-green-100 text-sm">Personalized for your farm</p>
                </div>
            </div>
        </div>
        
        <!-- Content -->
        <div class="p-6">
            <div class="prose prose-green max-w-none text-gray-800 leading-relaxed">
                {{ suggestion|safe }}
            </div>
        </div>
        
        <!-- Footer Action -->
        <div class="bg-gray-50 px-6 py-4 border-t border-gray-100">
            <div class="flex items-center justify-between">
                <span class="text-sm text-gray-600 flex items-center">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></span>
                    AI-Powered Analysis
                </span>
                <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" 
                        class="text-green-600 hover:text-green-700 text-sm font-medium flex items-center space-x-1 transition-colors">
                    <span>New Search</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<!-- Enhanced Animations and Styles -->
<style>
/* Enhanced Animations */
@keyframes fade-in-down {
    from { 
        opacity: 0; 
        transform: translateY(-20px); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0); 
    }
}

@keyframes fade-in-up {
    from { 
        opacity: 0; 
        transform: translateY(30px); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0); 
    }
}

@keyframes slide-in {
    from { 
        opacity: 0; 
        transform: translateX(-20px); 
    }
    to { 
        opacity: 1; 
        transform: translateX(0); 
    }
}

@keyframes slide-up-result {
    from { 
        opacity: 0; 
        transform: translateY(40px) scale(0.95); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
    }
}

@keyframes bounce-gentle {
    0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
    }
    40% {
        transform: translateY(-4px);
    }
    60% {
        transform: translateY(-2px);
    }
}

.animate-fade-in-down {
    animation: fade-in-down 0.6s ease-out forwards;
}

.animate-fade-in-up {
    animation: fade-in-up 0.8s ease-out forwards;
}

.animate-slide-in {
    opacity: 0;
    animation: slide-in 0.6s ease-out forwards;
}

.animate-slide-up-result {
    animation: slide-up-result 0.7s ease-out forwards;
}

.animate-bounce-gentle {
    animation: bounce-gentle 2s infinite;
}

/* Enhanced Form Styles */
.form-group {
    position: relative;
}

.form-group input:focus + .absolute,
.form-group textarea:focus + .absolute {
    color: #10b981;
}

/* Loading state for submit button */
.submit-btn:active {
    background: linear-gradient(to right, #059669, #047857);
}

.submit-btn:active svg {
    transform: translateX(2px);
}

/* Mobile-specific improvements */
@media (max-width: 640px) {
    .max-w-md {
        max-width: 100%;
        margin-left: 0.5rem;
        margin-right: 0.5rem;
    }
    
    /* Improved touch targets */
    input, textarea, button {
        min-height: 48px;
    }
    
    /* Better spacing on mobile */
    .space-y-6 > * + * {
        margin-top: 1.25rem;
    }
}

/* Comprehensive Dark Mode */
@media (prefers-color-scheme: dark) {
    /* Background adjustments */
    .bg-gradient-to-br {
        background: linear-gradient(to bottom right, #0f172a, #1e293b, #334155);
    }
    
    .bg-white\/80 {
        background-color: rgba(30, 41, 59, 0.9);
        border-color: rgba(71, 85, 105, 0.3);
    }
    
    .bg-white\/90 {
        background-color: rgba(30, 41, 59, 0.95);
        border-color: rgba(34, 197, 94, 0.3);
    }
    
    /* Text color fixes */
    .text-gray-700 {
        color: #e2e8f0 !important;
    }
    
    .text-gray-800 {
        color: #f1f5f9 !important;
    }
    
    .text-gray-600 {
        color: #cbd5e1 !important;
    }
    
    .text-gray-500 {
        color: #94a3b8 !important;
    }
    
    .text-gray-400 {
        color: #64748b !important;
    }
    
    /* Input field adjustments */
    .bg-gray-50\/50 {
        background-color: rgba(51, 65, 85, 0.5) !important;
        border-color: rgba(71, 85, 105, 0.5) !important;
    }
    
    .hover\:bg-white:hover {
        background-color: rgba(51, 65, 85, 0.8) !important;
    }
    
    .focus\:bg-white:focus {
        background-color: rgba(51, 65, 85, 0.9) !important;
    }
    
    .placeholder-gray-400::placeholder {
        color: #94a3b8 !important;
    }
    
    /* Border adjustments */
    .border-gray-200 {
        border-color: rgba(71, 85, 105, 0.6) !important;
    }
    
    .border-gray-100 {
        border-color: rgba(71, 85, 105, 0.4) !important;
    }
    
    /* Footer and result section */
    .bg-gray-50 {
        background-color: rgba(51, 65, 85, 0.3) !important;
    }
    
    /* Gradient text adjustment */
    .bg-gradient-to-r.from-green-700.to-emerald-700 {
        background: linear-gradient(to right, #10b981, #059669);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    
    /* Validation colors for dark mode */
    .border-red-300 {
        border-color: #fca5a5 !important;
    }
    
    .border-green-300 {
        border-color: #86efac !important;
    }
    
    /* Icon colors */
    .text-blue-500 {
        color: #60a5fa !important;
    }
    
    .text-blue-400 {
        color: #93c5fd !important;
    }
    
    .text-green-500 {
        color: #34d399 !important;
    }
    
    .text-green-600 {
        color: #10b981 !important;
    }
    
    .hover\:text-green-700:hover {
        color: #059669 !important;
    }
}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* Focus improvements for better accessibility */
input:focus-visible, textarea:focus-visible, button:focus-visible {
    outline: 2px solid #10b981;
    outline-offset: 2px;
}
</style>

<!-- Progressive enhancement script -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add subtle form validation feedback
    const inputs = document.querySelectorAll('input[required], textarea[required]');
    
    inputs.forEach(input => {
        input.addEventListener('blur', function() {
            if (this.value.trim() === '') {
                this.classList.add('border-red-300');
                this.classList.remove('border-gray-200');
            } else {
                this.classList.remove('border-red-300');
                this.classList.add('border-green-300');
            }
        });
        
        input.addEventListener('input', function() {
            if (this.value.trim() !== '') {
                this.classList.remove('border-red-300');
                this.classList.add('border-green-300');
            }
        });
    });
    
    // Add loading state to submit button
    const form = document.querySelector('form');
    const submitBtn = document.querySelector('.submit-btn');
    
    if (form && submitBtn) {
        form.addEventListener('submit', function() {
            submitBtn.innerHTML = `
                <div class="flex items-center space-x-2">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>Analyzing...</span>
                </div>
            `;
            submitBtn.disabled = true;
        });
    }
});
</script>
{% endblock %}